R.<x> = PolynomialRing(QQ)
F.<a> = NumberField(x^2 + 31)
S.<y> = PolynomialRing(F)
H.<b> = F.extension(y^3 + y + 1)
T.<z> = PolynomialRing(H)
H1.<c> = H.extension(z^3 - 3*z + 1)
U.<w> = PolynomialRing(H1)

##minimal poly for the elliptic units

f = w^9 - 367744952094930225377797751819760374868552328011072815115087248447682666277876276889243435132638951397654968834341322310221270135044738*w^8 + 8288548681130489565549607913766780827688865581295760324723333391946660039594510180089202228275219236631867588829763457950743766284507420587281234640175640289848252231511775635309866718116165891722041*w^7 - 48922042206710658183559464005146814043744003863880318449829040295578350838220973862307252792563635072761227653369919616732548743827802790352568718991054377938066474346938502994686232163170600681738918371521997259554565959051676084568833640443141241682677517308360*w^6 + 1813775934795687135480169039932755491029049579125603175235767893096579562780766623365452026379939906748196645762220273628754003416789247109089033453660868952413738547504469346697391719515180262525563102832486548486541685531970316151353635706393815635238224051770875694151584912*w^5 - 4282049873358512724995998122740507659492131115908114264744270464782334466761048746444745287357078248026857449435663537442345656901278265576451453251164660944352857033804425515893328828010864679078450389531791514399798970178555244828732677044388698575663734459457572048*w^4 + 7250110492035347502216769716327679333390032007948566634263731589654845859702982559997877677129019474645782418889346059502788850254755068305457195072864382340328566157361231117491673102943626406335980357149423545537484434373923327736258927502978254629871815080*w^3 - 27377629412892174121140599322999531223474988045238614992745582054787120743357676752298921018025217012907690964367142496024369489165980772469861233312539645657024296473179554178907075232623252305450051794460275529444899009741227857*w^2 + 46102161435303216563462645120431066661673763716696677252590701184058321971259576041004177820732632096951184633214657867544484539652679644659127316870583456728062205553613534763361603772325540336329090*w - 196627050475552913618075908526912116283103450944214766927315415537966391196809

froots = f.roots()
ellUnits = []
for i in range(0, 9):
    ellUnits.append(froots[i][0])

StarkUnits = []
for i in range(0, 9):
    g = w^(9*12) - ellUnits[i]^2
    groots = g.roots()
    for j in range(0, len(groots)):
        StarkUnits.append(groots[j][0])

StUnitMinPoly = 1  ## this one does not work
StUnitMinPolyBig = 1
for i in range(0, 9):
    StUnitMinPoly = StUnitMinPoly*(w - StarkUnits[2*i])
    StUnitMinPolyBig = StUnitMinPolyBig*(w - StarkUnits[2*i])*(w - StarkUnits[2*i + 1])

## save(StUnitMinPolyBig, "StUnitMinPolyBig")

## StUnitMinPolyBig is x^18 - 95922*x^16 - 42416919*x^14 - 5198040648*x^12 + 20345034384*x^10 - 11706266448*x^8 + 2988501480*x^6 + 210167055*x^4 + 24822450*x^2 - 729

## StUnitMinPolyBig factors over Q as
## (x^9 - 306*x^8 - 1143*x^7 - 71640*x^6 + 60156*x^5 + 117180*x^4 + 25704*x^3 - 7371*x^2 + 5022*x - 27) * (x^9 + 306*x^8 - 1143*x^7 + 71640*x^6 + 60156*x^5 - 117180*x^4 + 25704*x^3 + 7371*x^2 + 5022*x + 27)






 






